<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>OpenLayers: TextButtonPanel</title>
    <script src="lib/OpenLayers.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <!--<script src="lib/Firebug/firebug.js"></script>-->
    <link rel="stylesheet" href="theme/default/style.css" type="text/css">
    <!-- <link rel="stylesheet" href="style.css" type="text/css"> -->
    <style type="text/css">
          .olControlCustomButtonToggleItemActive {
           background:#336699;
           border:5px solid #202020;
           cursor: pointer;
           height: 28px;
           width:  28px;
       }
       .olControlCustomButtonToggleItemInactive {
           background:#003366;
           border:5px solid #202020;
           cursor: pointer;
           height: 28px;
           width:  28px;
       }
        
        
        .olControlPanel.hpanel { 
          top: auto;
          bottom: 8px;
          left: 8px;
          right: auto;
        }
		
		.olControlTextButtonPanel.vButtonPanel { 
          top: 8px;
		  left: auto;
          right: 8px;
        }
        
        .button1ItemInactive:after,
        .button1ItemActive:after {
            content: "Menu";
        }
        
        .button2ItemInactive:after,
        .button2ItemActive:after {
            content: "Settings";
        }
        
        .button3ItemInactive:after,
        .button3ItemActive:after {
            content: "Layers";
        }
        
        .button4ItemInactive:after,
        .button4ItemActive:after {
            content: "Button 4";
        }
        
        .button5ItemInactive:after,
        .button5ItemActive:after {
            content: "Button 5";
        }
        
    </style>
    
   
    <script type="text/javascript">
        


        var geographic = new OpenLayers.Projection("EPSG:4326");
        var mercator   = new OpenLayers.Projection("EPSG:900913");

        var lon = 5;
        var lat = 40;
        var zoom = 5;
        var map, layer;

        function init(){
            
            map = new OpenLayers.Map( 'map', {
                
            eventListeners: {
                        "moveend": mapEvent,
                        "zoomend": mapEvent,
                        "changelayer": mapLayerChanged,
                        "changebaselayer": mapBaseLayerChanged
            }});
			
			//Buttons
			var b1 = new OpenLayers.Control.Button({
				trigger: function(){//Toggle visibility of submenubuttons
					$(".button2ItemInactive").toggle();
					$(".button2ItemActive").toggle();
					$(".button3ItemInactive").toggle();
					$(".button3ItemActive").toggle();
				},
				displayClass: "button1"
			});
			var b2 = new OpenLayers.Control.Button({
				trigger: function(){},
				displayClass: "button2"
			});
			var b3 = new OpenLayers.Control.Button({
				trigger: function(){},
				displayClass: "button3"
			});
			
			//ButtonPanel
			var vButtonPanel = new OpenLayers.Control.TextButtonPanel({
				vertical: true,
				additionalClass: "vButtonPanel"
			});
			
			vButtonPanel.addControls([b1,b2,b3]);

             //Layer part 
            var ol_wms = new OpenLayers.Layer.WMS( "OpenLayers WMS", "http://vmap0.tiles.osgeo.org/wms/vmap0?", {layers: 'basic'} , {tileOrigin: new OpenLayers.LonLat(-180, -90)});
            var layer2 =  new OpenLayers.Layer.WMS(
            "Global Imagery",
            "http://maps.opengeo.org/geowebcache/service/wms",
            {layers: "bluemarble"},
            {tileOrigin: new OpenLayers.LonLat(-180, -90)}
            );
            
            map.addLayer(ol_wms);


            function knapptryck(){
                console.log("Tryckt !");
            } 
            function drawObject(layer){

            }
            function drawLayer(){

            }
            function mapEvent(event) {
                    console.log(event.type);
            }
            function mapBaseLayerChanged(event) {
                    console.log(event.type );
            }
                function mapLayerChanged(event) {
                    console.log(event.type + " " + event.layer.name + " " + event.property);
            }


            var map_event_function = function(){
                console.log('Klickar på kartan');
                map.layers[0].setOpacity(0.3);
                
            }
            //Då knappen är aktiv som så lyssnar man på kartans eventlistener !
            //Create a function for the toggle button
            var toggle_button_activate_func = function(){
                console.log('toggle_button_activate_func');
                //Attach the map_event_function to the map
                map.events.register('click', map, map_event_function);
            }
            //Tar bort eventlistener
            var toggle_button_deactivate_func = function(){
                 console.log('toggle_button_deactivate_func');
                //Remove the map_event_function from the map
                map.events.unregister('click', map, map_event_function);
                //Restore the layer's opacity
                map.layers[0].setOpacity(1);
            }
           
            //Control part
            var layerPanel = new OpenLayers.Control.Panel({
        		displayClass: "layerPanel",
        					
            });
        
             //Create the toggle button object
            var custom_toggle_button = new OpenLayers.Control.Button({
                displayClass: 'olControlCustomButtonToggle',
                eventListeners: {
                    "activate": toggle_button_activate_func,
                    "deactivate": toggle_button_deactivate_func
                },
                type: OpenLayers.Control.TYPE_TOGGLE
                
            });
    
            var vpanel = new OpenLayers.Control.Panel({
                
                additionalClass: "vpanel"
            });


            vpanel.addControls([custom_toggle_button]);
           
            map.addControl(vpanel);
			map.addControl(vButtonPanel);
			
			//Submenubuttons start hidden
			$(".button2ItemInactive").hide();
			$(".button2ItemActive").hide();
			$(".button3ItemInactive").hide();
			$(".button3ItemActive").hide();

              
        }
    </script>
  </head>
  <body onload="init()">   
    <div id="panel"></div>
    <div id="map" class="smallmap olMap" style='width: 500px; height: 500px;'></div>
    <div id ="output"></div>
  </body>
</html>